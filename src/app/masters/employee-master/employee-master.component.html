<div class="d-flex" id="wrapper">
    <app-sidebar></app-sidebar>
    <div class="d-block w-100">
        <app-header></app-header>
        <div class="mt-2 px-1"> 
            <div class="text-center mb-2 mt-4">
                <h2>Employee Master</h2>
            </div>
            <div class="grid-view" *ngIf="!showForm">
                <div class="text-end mt-3 px-5">
                    <button class="btn btn-primary" type="button" (click)="onShowEntryForm()">+ Add Employee</button>
                </div>
                <div class="mt-3 text-center" *ngIf="!showData">
                    <h3>No employees added</h3>
                </div>
                <div class="px-5 mt-3" *ngIf="showData">
                    <table class="table table-bordered table-responsive" datatable [dtOptions]="dtOptions">
                        <thead>
                            <tr class="text-center">
                                <th class="col">Username</th>
                                <th class="col">Name</th>
                                <th class="col">ID</th>
                                <th class="col">Type</th>
                                <th class="col">Gender</th>
                                <th class="col" width="10%">Operations</th>
                                <th class="col" width="10%">isDeleted</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let u of users; let i=index">
                                <td>{{u.username}}</td>
                                <td>{{u.related_profile.employee_name}}</td>
                                <td>{{u.related_profile.employee_id}}</td>
                                <td>{{u.related_profile.employee_type}}</td>
                                <td>{{u.related_profile.employee_gender}}</td>
                                <td class="text-center"><a class="button" (click)="onShowForm(u.id)">Edit</a></td>
                                <td class="text-center"><input type="checkbox" (click)="isDelete(u.related_profile.id,u.related_profile.employee_isDeleted)" checked *ngIf="u.related_profile.employee_isDeleted">
                                                        <input type="checkbox" (click)="isDelete(u.related_profile.id,u.related_profile.employee_isDeleted)" *ngIf="!u.related_profile.employee_isDeleted"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="form-view mt-5 px-5" *ngIf="showForm">
                <form #reg="ngForm" (ngSubmit)="onRegistration(reg.value, gender.value, bgroup.value, empType.value, group.value)">
                    <div class="image text-center mb-2">
                        <img src="{{ imgSrc }}" class="mb-2" style="height: 140px; width: 140px; border-radius: 20px;" id="img"/><br>
                        <label for="file" style="color: #579FDD; text-decoration: underline; cursor: pointer;">Change Photo</label>
                        <input type="file" id="file" (input)="onHandleEvent($event)" accept="image/png, image/jpeg, image/jpg" style="display: none" />
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label class="form-label">Name</label>
                            <input type="text" name="name" class="form-control" name="name" [(ngModel)]="e_name" #name="ngModel" required/>
                            <small class="text-danger" *ngIf="name.invalid && name.touched">Name Required</small>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Contact Number</label>
                            <input type="text" name="contact" maxLength="10" pattern="\d{10}" class="form-control" name="contact" [(ngModel)]="e_contact" #contact="ngModel" required/>
                            <div *ngIf="contact.touched">
                                <small class="text-danger" *ngIf="contact.errors?.required">Contact Number Required (Max Length: 10 digits)</small>
                                <small class="text-danger" *ngIf="contact.errors?.pattern">Invalid Contact Number</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Date of Birth</label>
                            <input type="date" class="form-control" name="dob" [(ngModel)]="e_dob" #dob="ngModel" required/>
                            <small class="text-danger" *ngIf="dob.invalid && dob.touched">Date of Birth is required</small>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-md-4">
                          <label for="exampleDatepicker1" class="form-label">Gender</label>
                          <select class="form-select" #gender name="gender" [(ngModel)]="e_gender">
                                <option value="N/A">----Select Gender----</option>
                                <option name="gender" value="Male">Male</option>
                                <option name="gender" value="Female">Female</option>
                                <option name="gender" value="Others">Others</option>
                          </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Email ID</label>
                            <input type="email" name="email" class="form-control" name="email" [(ngModel)]="e_email" #email="ngModel" required/>
                        </div>
                        <div class="col-md-4">
                              <label class="form-label" for="form3Example1w">Blood Group</label>
                              <select class="form-select" name="blood_group" #bgroup name="bgroup" [(ngModel)]="e_bgroup">
                                  <option value="N/A">Not Known</option>
                                  <option value="A +ve">A +ve</option>
                                  <option value="A -ve">A -ve</option>
                                  <option value="B +ve">B +ve</option>
                                  <option value="B -ve">B -ve</option>
                                  <option value="O +ve">O +ve</option>
                                  <option value="O -ve">O -ve</option>
                                  <option value="AB +ve">AB +ve</option>
                                  <option value="AB -ve">AB -ve</option>
                              </select>
                        </div>
                    </div>
                    <div class="form-outline mb-3 mt-3">
                        <label class="form-label">Corresponding Address</label>
                        <textarea class="form-control" name="address1" rows="4" cols="50" [(ngModel)]="emp_address1" #address1="ngModel" required></textarea>
                        <small class="text-danger" *ngIf="address1.invalid && address1.touched">Corresponding Address is required</small>
                    </div>
                    <div class="form-outline mb-3">
                        <input type="checkbox" name="check" (click)="onCheckAddress($event)"/>
                        <label>&nbsp;&nbsp;Same as Corresponding</label> 
                    </div>
                    <div class="form-outline mb-3">
                        <label class="form-label">Permanent Address</label>
                        <textarea name="address2" class="form-control"rows="4" cols="50" [(ngModel)]="emp_address2" #address2="ngModel" required></textarea>
                        <small class="text-danger" *ngIf="address2.invalid && address2.touched">Permanent Address is required</small>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <label class="form-label">Employee ID/Number</label>
                            <input type="text" class="form-control" name="employee_id" [(ngModel)]="e_id" #employee_id="ngModel" required/>
                            <small class="text-danger" *ngIf="employee_id.invalid && employee_id.touched">Employee ID is required</small>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Employee Type</label>
                            <select class="form-select" name="employee_type" #empType [(ngModel)]="e_type">
                                <option value="N/A">----Select Employee Type----</option>
                                <option value="Regular">Regular</option>
                                <option value="Ad-Hoc">Ad-Hoc</option>
                                <option value="Contractual">Contractual</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label">Role</label>
                                <select class="form-select" #group name="group" [(ngModel)]="e_role">
                                    <option value="0">----Select Role Type---</option>
                                    <option value="1">Admin</option>
                                    <option value="2">General User</option>
                                    <option value="3">Data Entry Operator</option>
                                    <option value="4">Approver</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <label class="form-label">Username</label>
                            <input type="text" name="username" class="form-control" [(ngModel)]="e_username" #username="ngModel" required/>
                            <small class="text-danger" *ngIf="username.invalid && username.touched">Username is Required</small>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Password</label>
                            <input type="password" name="password" class="form-control" ngModel #password="ngModel" required pattern="(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[$@$!%*?&])[A-Za-z\d$@$!%*?&].{8,}"/>
                            <div *ngIf="password.touched">
                                <small class="text-danger" *ngIf="password.errors?.required">Password Required</small>
                                <small class="text-danger" *ngIf="password.errors?.pattern">Password is Required (Minimum Length: 8 characters with atleast one capital alphabet letter (A-Z), one small alphabet letter (a-z), one number (0-9) and one sepcial character (.,?/!@#$%^&*))</small>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Confirm Password</label>
                            <input type="password" name="conf_password" class="form-control" ngModel #conf_password="ngModel"/>
                            <small class="text-danger" *ngIf="conf_password.value !== password.value">Password is did not match</small>
                        </div>
                    </div>
                    <div class="alert alert-success mt-4 mb-4" *ngIf="showAddSuccess">
                        Employee Registered Successfully !!
                    </div>
                    <div class="alert alert-success mt-4 mb-4" *ngIf="showUpdateSuccess">
                        Employee Details Updated Successfully !!
                    </div>
                    <div class="alert alert-danger mt-4 mb-4" *ngIf="showError">
                        Error !! Data already exists
                    </div>
                    <div class="mt-4 mb-5 text-end">
                        <button class="btn btn-primary mx-3" type="button" (click)="onHideForm()">Go Back</button>
                        <button class="btn btn-primary">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>